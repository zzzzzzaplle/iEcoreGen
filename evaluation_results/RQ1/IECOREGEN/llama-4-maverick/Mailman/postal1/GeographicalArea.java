/**
 * generated by Enhanced EcoreGen
 */
package edu.postal;

import java.util.Collection;

import org.eclipse.emf.common.notify.NotificationChain;

import org.eclipse.emf.common.util.EList;

import org.eclipse.emf.ecore.EClass;
import org.eclipse.emf.ecore.EObject;
import org.eclipse.emf.ecore.InternalEObject;

import org.eclipse.emf.ecore.impl.MinimalEObjectImpl;

import org.eclipse.emf.ecore.util.EObjectContainmentEList;
import org.eclipse.emf.ecore.util.EObjectResolvingEList;
import org.eclipse.emf.ecore.util.InternalEList;
import org.eclipse.emf.common.util.BasicEList;

/**
 * <!-- begin-user-doc -->
 * A representation of the model object '<em><b>Geographical Area</b></em>'.
 * <!-- end-user-doc -->
 *
 * <p>
 * The following features are supported:
 * </p>
 * <ul>
 *   <li>{@link edu.postal.GeographicalArea#getMailmen <em>Mailmen</em>}</li>
 *   <li>{@link edu.postal.GeographicalArea#getInhabitants <em>Inhabitants</em>}</li>
 *   <li>{@link edu.postal.GeographicalArea#getAllMails <em>All Mails</em>}</li>
 * </ul>
 *
 * @see edu.postal.PostalPackage#getGeographicalArea()
 * @model kind="class"
 * @generated
 */
public class GeographicalArea extends MinimalEObjectImpl.Container implements EObject
{
  /**
   * The cached value of the '{@link #getMailmen() <em>Mailmen</em>}' containment reference list.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getMailmen()
   * @generated
   * @ordered
   */
  protected EList<Mailman> mailmen;

  /**
   * The cached value of the '{@link #getInhabitants() <em>Inhabitants</em>}' containment reference list.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getInhabitants()
   * @generated
   * @ordered
   */
  protected EList<Inhabitant> inhabitants;

  /**
   * The cached value of the '{@link #getAllMails() <em>All Mails</em>}' reference list.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getAllMails()
   * @generated
   * @ordered
   */
  protected EList<RegisteredMail> allMails;

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  protected GeographicalArea()
  {
    super();
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @Override
  protected EClass eStaticClass()
  {
    return PostalPackage.Literals.GEOGRAPHICAL_AREA;
  }

  /**
   * Returns the value of the '<em><b>Mailmen</b></em>' containment reference list.
   * The list contents are of type {@link edu.postal.Mailman}.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @return the value of the '<em>Mailmen</em>' containment reference list.
   * @see edu.postal.PostalPackage#getGeographicalArea_Mailmen()
   * @model containment="true"
   * @generated
   */
  public EList<Mailman> getMailmen()
  {
    if (mailmen == null)
    {
      mailmen = new EObjectContainmentEList<Mailman>(Mailman.class, this, PostalPackage.GEOGRAPHICAL_AREA__MAILMEN);
    }
    return mailmen;
  }

  /**
   * Returns the value of the '<em><b>Inhabitants</b></em>' containment reference list.
   * The list contents are of type {@link edu.postal.Inhabitant}.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @return the value of the '<em>Inhabitants</em>' containment reference list.
   * @see edu.postal.PostalPackage#getGeographicalArea_Inhabitants()
   * @model containment="true"
   * @generated
   */
  public EList<Inhabitant> getInhabitants()
  {
    if (inhabitants == null)
    {
      inhabitants = new EObjectContainmentEList<Inhabitant>(Inhabitant.class, this, PostalPackage.GEOGRAPHICAL_AREA__INHABITANTS);
    }
    return inhabitants;
  }

  /**
   * Returns the value of the '<em><b>All Mails</b></em>' reference list.
   * The list contents are of type {@link edu.postal.RegisteredMail}.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @return the value of the '<em>All Mails</em>' reference list.
   * @see edu.postal.PostalPackage#getGeographicalArea_AllMails()
   * @model
   * @generated
   */
  public EList<RegisteredMail> getAllMails()
  {
    if (allMails == null)
    {
      allMails = new EObjectResolvingEList<RegisteredMail>(RegisteredMail.class, this, PostalPackage.GEOGRAPHICAL_AREA__ALL_MAILS);
    }
    return allMails;
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * <!-- begin-model-doc -->
   * Summary: Retrieves all registered mail items within a geographical area.
   * Algorithm: Return the list of all registered mail items in the area.
   * Input: None.
   * Output: 
   *  - List<RegisteredMail>: a list of all registered mail items in the area. 
   * Pre-condition: None.
   * Post-condition: None.
   * <!-- end-model-doc -->
   * @model kind="operation"
   *        annotation="http://www.ustb.edu.cn/sei/mde/EnhancedCodeGen generated='true'"
   * @generated NOT
   */
  public EList<RegisteredMail> getAllDeliveries()
  {
    return getAllMails();
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * <!-- begin-model-doc -->
   * Summary: Adds a new inhabitant to a geographical area.
   * Algorithm: Check if the inhabitant is already in the area. If not, add the inhabitant to the area.
   * Input: 
   *  - newInhabitant: the inhabitant to be added. It should be an instance of Inhabitant.
   * Output: 
   *  - boolean: true if the inhabitant is successfully added, false otherwise.
   * Pre-condition: 
   *  - newInhabitant is not null.
   * Post-condition: 
   *  - The inhabitant is added to the area's inhabitants list if the operation is successful.
   * <!-- end-model-doc -->
   * @model annotation="http://www.ustb.edu.cn/sei/mde/EnhancedCodeGen generated='true'"
   * @generated NOT
   */
  public boolean addInhabitant(final Inhabitant newInhabitant)
  {
    if (newInhabitant == null) {
        return false;
    }
    EList<Inhabitant> inhabitants = getInhabitants();
    if (!inhabitants.contains(newInhabitant)) {
        return inhabitants.add(newInhabitant);
    }
    return false;
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * <!-- begin-model-doc -->
   * Summary: Removes an inhabitant from a geographical area and deletes any registered mail addressed to them that has already been assigned to a mailman.
   * Algorithm: Check if the inhabitant exists in the area. If so, remove the inhabitant and delete relevant mail items.
   * Input: 
   *  - inhabitant: the inhabitant to be removed. It should be an instance of Inhabitant.
   * Output: 
   *  - boolean: true if the operation is successful, false otherwise.
   * Pre-condition: 
   *  - inhabitant is not null and belongs to the geographical area.
   * Post-condition: 
   *  - The inhabitant is removed from the area's inhabitants list and relevant mail items are deleted if the operation is successful.
   * <!-- end-model-doc -->
   * @model annotation="http://www.ustb.edu.cn/sei/mde/EnhancedCodeGen generated='true'"
   * @generated NOT
   */
  public boolean removeInhabitant(final Inhabitant newInhabitant)
  {
    if (newInhabitant == null || !getInhabitants().contains(newInhabitant)) {
        return false;
    }
    
    // Remove relevant mail items
    EList<RegisteredMail> mailsToRemove = new BasicEList<>();
    for (RegisteredMail mail : getAllMails()) {
        if (mail.getAddressee() == newInhabitant && mail.getCarrier() != null) {
            mailsToRemove.add(mail);
        }
    }
    getAllMails().removeAll(mailsToRemove);
    
    // Remove the inhabitant
    return getInhabitants().remove(newInhabitant);
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * <!-- begin-model-doc -->
   * Summary: Adds a new mailman to a geographical area if they are not already assigned to it.
   * Algorithm: Check if the mailman is already in the area. If not, add the mailman to the area.
   * Input: 
   *  - newMailman: the mailman to be added. It should be an instance of Mailman.
   * Output: 
   *  - boolean: true if the mailman is successfully added, false otherwise.
   * Pre-condition: 
   *  - newMailman is not null.
   * Post-condition: 
   *  - The mailman is added to the area's mailmen list if the operation is successful.
   * <!-- end-model-doc -->
   * @model annotation="http://www.ustb.edu.cn/sei/mde/EnhancedCodeGen generated='true'"
   * @generated NOT
   */
  public boolean addMailman(final Mailman newMailman)
  {
    if (newMailman == null) {
        return false;
    }
    EList<Mailman> mailmen = getMailmen();
    if (!mailmen.contains(newMailman)) {
        return mailmen.add(newMailman);
    }
    return false;
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * <!-- begin-model-doc -->
   * Summary: Removes a mailman from a geographical area after reassigning their deliveries to another mailman.
   * Algorithm: Check if the mailman to be removed exists in the area and if there's at least one other mailman to take over. Reassign the mailman's deliveries and then remove the mailman.
   * Input: 
   *  - mailmanToRemove: the mailman to be removed. It should be an instance of Mailman and belong to the geographical area.
   *  - newMailman: the mailman to take over the deliveries. It should be an instance of Mailman, belong to the geographical area, and not be the same as mailmanToRemove.
   * Output: 
   *  - boolean: true if the operation is successful, false otherwise.
   * Pre-condition: 
   *  - mailmanToRemove is not null and belongs to the geographical area.
   *  - newMailman is not null, belongs to the geographical area, and is different from mailmanToRemove.
   *  - There is at least one other mailman in the area after removal.
   * Post-condition: 
   *  - The mailman is removed from the area's mailmen list and their deliveries are reassigned if the operation is successful.
   * <!-- end-model-doc -->
   * @model annotation="http://www.ustb.edu.cn/sei/mde/EnhancedCodeGen generated='true'"
   * @generated NOT
   */
  public boolean removeMailman(final Mailman mailmanToRemove, final Mailman newMailman)
  {
    if (mailmanToRemove == null || newMailman == null || mailmanToRemove == newMailman || !getMailmen().contains(mailmanToRemove) || !getMailmen().contains(newMailman)) {
        return false;
    }
    
    // Reassign deliveries
    for (RegisteredMail mail : getAllMails()) {
        if (mail.getCarrier() == mailmanToRemove) {
            mail.setCarrier(newMailman);
        }
    }
    
    // Remove the mailman
    return getMailmen().remove(mailmanToRemove);
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * <!-- begin-model-doc -->
   * Summary: Assigns a mailman to deliver a registered mail item to an inhabitant.
   * Algorithm: Check if the mailman and the inhabitant belong to the same geographical area and if the mail is not already assigned. If so, assign the mailman to the mail item.
   * Input: 
   *  - carrier: the mailman to be assigned. It should be an instance of Mailman and belong to the same geographical area as the addressee.
   *  - addressee: the inhabitant receiving the mail. It should be an instance of Inhabitant and belong to the same geographical area as the carrier.
   *  - mail: the registered mail item to be delivered. It should be an instance of RegisteredMail and not be already assigned to a mailman.
   * Output: 
   *  - boolean: true if the assignment is successful, false otherwise.
   * Pre-condition: 
   *  - carrier is not null and belongs to the geographical area.
   *  - addressee is not null and belongs to the geographical area.
   *  - mail is not null and is not already assigned to a mailman.
   * Post-condition: 
   *  - The mail item is assigned to the mailman if the operation is successful.
   * <!-- end-model-doc -->
   * @model annotation="http://www.ustb.edu.cn/sei/mde/EnhancedCodeGen generated='true'"
   * @generated NOT
   */
  public boolean assignRegisteredMailDeliver(final Mailman carrier, final Inhabitant addressee, final RegisteredMail mail)
  {
    if (carrier == null || addressee == null || mail == null || !getMailmen().contains(carrier) || !getInhabitants().contains(addressee) || mail.getCarrier() != null) {
        return false;
    }
    
    mail.setCarrier(carrier);
    mail.setAddressee(addressee);
    if (!getAllMails().contains(mail)) {
        getAllMails().add(mail);
    }
    
    return true;
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * <!-- begin-model-doc -->
   * Summary: Lists all registered mail items assigned to a specified mailman.
   * Algorithm: Filter the list of registered mail items to include only those assigned to the given mailman.
   * Input: 
   *  - carrier: the mailman whose assigned mail items are to be listed. It should be an instance of Mailman.
   * Output: 
   *  - List<RegisteredMail>: a list of registered mail items assigned to the mailman, or null if none exist.
   * Pre-condition: 
   *  - carrier is not null and belongs to the geographical area.
   * Post-condition: None.
   * <!-- end-model-doc -->
   * @model annotation="http://www.ustb.edu.cn/sei/mde/EnhancedCodeGen generated='true'"
   * @generated NOT
   */
  public EList<RegisteredMail> listRegisteredMail(final Mailman carrier)
  {
    EList<RegisteredMail> result = new BasicEList<>();
    for (RegisteredMail mail : getAllMails()) {
        if (mail.getCarrier() == carrier) {
            result.add(mail);
        }
    }
    return result;
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * <!-- begin-model-doc -->
   * Summary: Lists all registered mail items directed to a specified inhabitant.
   * Algorithm: Filter the list of registered mail items to include only those directed to the given inhabitant.
   * Input: 
   *  - addressee: the inhabitant whose mail items are to be listed. It should be an instance of Inhabitant.
   * Output: 
   *  - List<RegisteredMail>: a list of registered mail items directed to the inhabitant, or null if none exist.
   * Pre-condition: 
   *  - addressee is not null and belongs to the geographical area.
   * Post-condition: None.
   * <!-- end-model-doc -->
   * @model annotation="http://www.ustb.edu.cn/sei/mde/EnhancedCodeGen generated='true'"
   * @generated NOT
   */
  public EList<RegisteredMail> listRegisteredMailWithInhabitant(final Inhabitant addressee)
  {
    EList<RegisteredMail> result = new BasicEList<>();
    for (RegisteredMail mail : getAllMails()) {
        if (mail.getAddressee() == addressee) {
            result.add(mail);
        }
    }
    return result;
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @Override
  public NotificationChain eInverseRemove(InternalEObject otherEnd, int featureID, NotificationChain msgs)
  {
    switch (featureID)
    {
      case PostalPackage.GEOGRAPHICAL_AREA__MAILMEN:
        return ((InternalEList<?>)getMailmen()).basicRemove(otherEnd, msgs);
      case PostalPackage.GEOGRAPHICAL_AREA__INHABITANTS:
        return ((InternalEList<?>)getInhabitants()).basicRemove(otherEnd, msgs);
    }
    return super.eInverseRemove(otherEnd, featureID, msgs);
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @Override
  public Object eGet(int featureID, boolean resolve, boolean coreType)
  {
    switch (featureID)
    {
      case PostalPackage.GEOGRAPHICAL_AREA__MAILMEN:
        return getMailmen();
      case PostalPackage.GEOGRAPHICAL_AREA__INHABITANTS:
        return getInhabitants();
      case PostalPackage.GEOGRAPHICAL_AREA__ALL_MAILS:
        return getAllMails();
    }
    return super.eGet(featureID, resolve, coreType);
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @SuppressWarnings("unchecked")
  @Override
  public void eSet(int featureID, Object newValue)
  {
    switch (featureID)
    {
      case PostalPackage.GEOGRAPHICAL_AREA__MAILMEN:
        getMailmen().clear();
        getMailmen().addAll((Collection<? extends Mailman>)newValue);
        return;
      case PostalPackage.GEOGRAPHICAL_AREA__INHABITANTS:
        getInhabitants().clear();
        getInhabitants().addAll((Collection<? extends Inhabitant>)newValue);
        return;
      case PostalPackage.GEOGRAPHICAL_AREA__ALL_MAILS:
        getAllMails().clear();
        getAllMails().addAll((Collection<? extends RegisteredMail>)newValue);
        return;
    }
    super.eSet(featureID, newValue);
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @Override
  public void eUnset(int featureID)
  {
    switch (featureID)
    {
      case PostalPackage.GEOGRAPHICAL_AREA__MAILMEN:
        getMailmen().clear();
        return;
      case PostalPackage.GEOGRAPHICAL_AREA__INHABITANTS:
        getInhabitants().clear();
        return;
      case PostalPackage.GEOGRAPHICAL_AREA__ALL_MAILS:
        getAllMails().clear();
        return;
    }
    super.eUnset(featureID);
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @Override
  public boolean eIsSet(int featureID)
  {
    switch (featureID)
    {
      case PostalPackage.GEOGRAPHICAL_AREA__MAILMEN:
        return mailmen != null && !mailmen.isEmpty();
      case PostalPackage.GEOGRAPHICAL_AREA__INHABITANTS:
        return inhabitants != null && !inhabitants.isEmpty();
      case PostalPackage.GEOGRAPHICAL_AREA__ALL_MAILS:
        return allMails != null && !allMails.isEmpty();
    }
    return super.eIsSet(featureID);
  }

} // GeographicalArea
