/**
 * generated by Enhanced EcoreGen
 */
package edu.postal;

import java.util.Collection;

import org.eclipse.emf.common.notify.NotificationChain;

import org.eclipse.emf.common.util.EList;

import org.eclipse.emf.ecore.EClass;
import org.eclipse.emf.ecore.EObject;
import org.eclipse.emf.ecore.InternalEObject;

import org.eclipse.emf.ecore.impl.MinimalEObjectImpl;

import org.eclipse.emf.ecore.util.EObjectContainmentEList;
import org.eclipse.emf.ecore.util.EObjectResolvingEList;
import org.eclipse.emf.ecore.util.InternalEList;
import org.eclipse.emf.common.util.BasicEList;

/**
 * <!-- begin-user-doc -->
 * A representation of the model object '<em><b>Geographical Area</b></em>'.
 * <!-- end-user-doc -->
 *
 * <p>
 * The following features are supported:
 * </p>
 * <ul>
 *   <li>{@link edu.postal.GeographicalArea#getMailmen <em>Mailmen</em>}</li>
 *   <li>{@link edu.postal.GeographicalArea#getInhabitants <em>Inhabitants</em>}</li>
 *   <li>{@link edu.postal.GeographicalArea#getAllMails <em>All Mails</em>}</li>
 * </ul>
 *
 * @see edu.postal.PostalPackage#getGeographicalArea()
 * @model kind="class"
 * @generated
 */
public class GeographicalArea extends MinimalEObjectImpl.Container implements EObject
{
  /**
   * The cached value of the '{@link #getMailmen() <em>Mailmen</em>}' containment reference list.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getMailmen()
   * @generated
   * @ordered
   */
  protected EList<Mailman> mailmen;

  /**
   * The cached value of the '{@link #getInhabitants() <em>Inhabitants</em>}' containment reference list.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getInhabitants()
   * @generated
   * @ordered
   */
  protected EList<Inhabitant> inhabitants;

  /**
   * The cached value of the '{@link #getAllMails() <em>All Mails</em>}' reference list.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getAllMails()
   * @generated
   * @ordered
   */
  protected EList<RegisteredMail> allMails;

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  protected GeographicalArea()
  {
    super();
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @Override
  protected EClass eStaticClass()
  {
    return PostalPackage.Literals.GEOGRAPHICAL_AREA;
  }

  /**
   * Returns the value of the '<em><b>Mailmen</b></em>' containment reference list.
   * The list contents are of type {@link edu.postal.Mailman}.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @return the value of the '<em>Mailmen</em>' containment reference list.
   * @see edu.postal.PostalPackage#getGeographicalArea_Mailmen()
   * @model containment="true"
   * @generated
   */
  public EList<Mailman> getMailmen()
  {
    if (mailmen == null)
    {
      mailmen = new EObjectContainmentEList<Mailman>(Mailman.class, this, PostalPackage.GEOGRAPHICAL_AREA__MAILMEN);
    }
    return mailmen;
  }

  /**
   * Returns the value of the '<em><b>Inhabitants</b></em>' containment reference list.
   * The list contents are of type {@link edu.postal.Inhabitant}.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @return the value of the '<em>Inhabitants</em>' containment reference list.
   * @see edu.postal.PostalPackage#getGeographicalArea_Inhabitants()
   * @model containment="true"
   * @generated
   */
  public EList<Inhabitant> getInhabitants()
  {
    if (inhabitants == null)
    {
      inhabitants = new EObjectContainmentEList<Inhabitant>(Inhabitant.class, this, PostalPackage.GEOGRAPHICAL_AREA__INHABITANTS);
    }
    return inhabitants;
  }

  /**
   * Returns the value of the '<em><b>All Mails</b></em>' reference list.
   * The list contents are of type {@link edu.postal.RegisteredMail}.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @return the value of the '<em>All Mails</em>' reference list.
   * @see edu.postal.PostalPackage#getGeographicalArea_AllMails()
   * @model
   * @generated
   */
  public EList<RegisteredMail> getAllMails()
  {
    if (allMails == null)
    {
      allMails = new EObjectResolvingEList<RegisteredMail>(RegisteredMail.class, this, PostalPackage.GEOGRAPHICAL_AREA__ALL_MAILS);
    }
    return allMails;
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * <!-- begin-model-doc -->
   * Summary: Retrieves all registered mail items within the geographical area.
   * Algorithm: Return the list of all registered mail items associated with the geographical area.
   * Input: None.
   * Output: List<RegisteredMail> - a list of all registered mail items. It could be empty if there are no mail items.
   * <!-- end-model-doc -->
   * @model kind="operation"
   *        annotation="http://www.ustb.edu.cn/sei/mde/EnhancedCodeGen generated='true'"
   * @generated NOT
   */
  public EList<RegisteredMail> getAllDeliveries()
  {
    return getAllMails();
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * <!-- begin-model-doc -->
   * Summary: Adds a new inhabitant to the geographical area.
   * Algorithm: Check if the inhabitant already exists in the area. If not, add the inhabitant to the list of inhabitants and return true. Otherwise, return false.
   * Input: newInhabitant - the inhabitant to be added. It should be an instance of Inhabitant.
   * Output: boolean - true if the inhabitant is added successfully, false otherwise.
   * Pre-condition: newInhabitant should not be null.
   * Post-condition: The inhabitant is added to the list of inhabitants if it didn't exist before.
   * <!-- end-model-doc -->
   * @model annotation="http://www.ustb.edu.cn/sei/mde/EnhancedCodeGen generated='true'"
   * @generated NOT
   */
  public boolean addInhabitant(final Inhabitant newInhabitant)
  {
    if (newInhabitant == null || getInhabitants().contains(newInhabitant)) {
      return false;
    }
    return getInhabitants().add(newInhabitant);
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * <!-- begin-model-doc -->
   * Summary: Removes an inhabitant from the geographical area and deletes any registered mail addressed to them that has already been assigned to a mailman.
   * Algorithm: 
   *   1. Check if the inhabitant exists in the area.
   *   2. Remove the inhabitant from the list of inhabitants.
   *   3. Filter and remove registered mail items addressed to the inhabitant that have been assigned to a mailman.
   *   4. Return true if the operation is successful, false otherwise.
   * Input: inhabitantToRemove - the inhabitant to be removed. It should be an instance of Inhabitant.
   * Output: boolean - true if the removal is successful, false otherwise.
   * Pre-condition: inhabitantToRemove should not be null and should be associated with the geographical area.
   * Post-condition: The inhabitant is removed from the list of inhabitants, and relevant registered mail items are deleted.
   * <!-- end-model-doc -->
   * @model annotation="http://www.ustb.edu.cn/sei/mde/EnhancedCodeGen generated='true'"
   * @generated NOT
   */
  public boolean removeInhabitant(final Inhabitant newInhabitant)
  {
    if (newInhabitant == null || !getInhabitants().contains(newInhabitant)) {
      return false;
    }
    getInhabitants().remove(newInhabitant);
    EList<RegisteredMail> mailsToRemove = new BasicEList<RegisteredMail>();
    for (RegisteredMail mail : getAllMails()) {
      if (mail.getAddressee() == newInhabitant && mail.getCarrier() != null) {
        mailsToRemove.add(mail);
      }
    }
    getAllMails().removeAll(mailsToRemove);
    return true;
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * <!-- begin-model-doc -->
   * Summary: Adds a new mailman to the geographical area if they are not already assigned.
   * Algorithm: Check if the mailman is already in the list of mailmen. If not, add the mailman to the list and return true. Otherwise, return false.
   * Input: newMailman - the mailman to be added. It should be an instance of Mailman.
   * Output: boolean - true if the mailman is added successfully, false otherwise.
   * Pre-condition: newMailman should not be null and should be associated with the geographical area.
   * Post-condition: The mailman is added to the list of mailmen if they didn't exist before.
   * <!-- end-model-doc -->
   * @model annotation="http://www.ustb.edu.cn/sei/mde/EnhancedCodeGen generated='true'"
   * @generated NOT
   */
  public boolean addMailman(final Mailman newMailman)
  {
    if (newMailman == null || getMailmen().contains(newMailman)) {
      return false;
    }
    return getMailmen().add(newMailman);
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * <!-- begin-model-doc -->
   * Summary: Removes a mailman from the geographical area after reassigning their deliveries to another mailman.
   * Algorithm: 
   *   1. Check if the mailman to be removed and the new mailman are in the same geographical area and if there is more than one mailman in the area.
   *   2. Reassign all registered mail items assigned to the mailman to be removed to the new mailman.
   *   3. Remove the mailman from the list of mailmen.
   *   4. Return true if the operation is successful, false otherwise.
   * Input: 
   *   - mailmanToRemove: the mailman to be removed. It should be an instance of Mailman.
   *   - newMailman: the mailman to take over the deliveries. It should be an instance of Mailman and different from mailmanToRemove.
   * Output: boolean - true if the removal is successful, false otherwise.
   * Pre-condition: 
   *   - Both mailmanToRemove and newMailman should not be null and should be associated with the geographical area.
   *   - There should be more than one mailman in the geographical area.
   * Post-condition: The mailman is removed from the list of mailmen, and their deliveries are reassigned to the new mailman.
   * <!-- end-model-doc -->
   * @model annotation="http://www.ustb.edu.cn/sei/mde/EnhancedCodeGen generated='true'"
   * @generated NOT
   */
  public boolean removeMailman(final Mailman mailmanToRemove, final Mailman newMailman)
  {
    if (mailmanToRemove == null || newMailman == null || mailmanToRemove == newMailman || !getMailmen().contains(mailmanToRemove) || !getMailmen().contains(newMailman) || getMailmen().size() <= 1) {
      return false;
    }
    for (RegisteredMail mail : getAllMails()) {
      if (mail.getCarrier() == mailmanToRemove) {
        mail.setCarrier(newMailman);
      }
    }
    return getMailmen().remove(mailmanToRemove);
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * <!-- begin-model-doc -->
   * Summary: Assigns a mailman to deliver a registered mail item to an inhabitant.
   * Algorithm: Check if the mailman and the inhabitant are in the same geographical area and if the mail is not already assigned. If both conditions are met, assign the mailman to the mail item and return true. Otherwise, return false.
   * Input: 
   *   - carrier: the mailman to be assigned. It should be an instance of Mailman and associated with the geographical area.
   *   - addressee: the inhabitant receiving the mail. It should be an instance of Inhabitant and associated with the geographical area.
   *   - mail: the registered mail item to be delivered. It should be an instance of RegisteredMail.
   * Output: boolean - true if the assignment is successful, false otherwise.
   * Pre-condition: 
   *   - carrier, addressee, and mail should not be null.
   *   - carrier and addressee should be associated with the same geographical area.
   *   - mail should not be already assigned to a carrier.
   * Post-condition: The mail item is assigned to the mailman if all conditions are met.
   * <!-- end-model-doc -->
   * @model annotation="http://www.ustb.edu.cn/sei/mde/EnhancedCodeGen generated='true'"
   * @generated NOT
   */
  public boolean assignRegisteredMailDeliver(final Mailman carrier, final Inhabitant addressee, final RegisteredMail mail)
  {
    if (carrier == null || addressee == null || mail == null || !getMailmen().contains(carrier) || !getInhabitants().contains(addressee) || mail.getCarrier() != null) {
      return false;
    }
    mail.setCarrier(carrier);
    mail.setAddressee(addressee);
    if (!getAllMails().contains(mail)) {
      getAllMails().add(mail);
    }
    return true;
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * <!-- begin-model-doc -->
   * Summary: Lists all registered mail items assigned to a specified mailman.
   * Algorithm: Filter the list of registered mail items to include only those assigned to the given mailman.
   * Input: carrier - the mailman for whom to list the mail items. It should be an instance of Mailman.
   * Output: List<RegisteredMail> - a list of registered mail items assigned to the mailman. Returns null if none exist.
   * Pre-condition: carrier should not be null and should be associated with the geographical area.
   * <!-- end-model-doc -->
   * @model annotation="http://www.ustb.edu.cn/sei/mde/EnhancedCodeGen generated='true'"
   * @generated NOT
   */
  public EList<RegisteredMail> listRegisteredMail(final Mailman carrier)
  {
    EList<RegisteredMail> result = new BasicEList<RegisteredMail>();
    if (carrier == null || !getMailmen().contains(carrier)) {
      return null;
    }
    for (RegisteredMail mail : getAllMails()) {
      if (mail.getCarrier() == carrier) {
        result.add(mail);
      }
    }
    return result.isEmpty() ? null : result;
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * <!-- begin-model-doc -->
   * Summary: Lists all registered mail items directed to a specified inhabitant.
   * Algorithm: Filter the list of registered mail items to include only those directed to the given inhabitant.
   * Input: addressee - the inhabitant for whom to list the mail items. It should be an instance of Inhabitant.
   * Output: List<RegisteredMail> - a list of registered mail items directed to the inhabitant. Returns null if none exist.
   * Pre-condition: addressee should not be null and should be associated with the geographical area.
   * <!-- end-model-doc -->
   * @model annotation="http://www.ustb.edu.cn/sei/mde/EnhancedCodeGen generated='true'"
   * @generated NOT
   */
  public EList<RegisteredMail> listRegisteredMailWithInhabitant(final Inhabitant addressee)
  {
    EList<RegisteredMail> result = new BasicEList<RegisteredMail>();
    if (addressee == null || !getInhabitants().contains(addressee)) {
      return null;
    }
    for (RegisteredMail mail : getAllMails()) {
      if (mail.getAddressee() == addressee) {
        result.add(mail);
      }
    }
    return result.isEmpty() ? null : result;
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @Override
  public NotificationChain eInverseRemove(InternalEObject otherEnd, int featureID, NotificationChain msgs)
  {
    switch (featureID)
    {
      case PostalPackage.GEOGRAPHICAL_AREA__MAILMEN:
        return ((InternalEList<?>)getMailmen()).basicRemove(otherEnd, msgs);
      case PostalPackage.GEOGRAPHICAL_AREA__INHABITANTS:
        return ((InternalEList<?>)getInhabitants()).basicRemove(otherEnd, msgs);
    }
    return super.eInverseRemove(otherEnd, featureID, msgs);
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @Override
  public Object eGet(int featureID, boolean resolve, boolean coreType)
  {
    switch (featureID)
    {
      case PostalPackage.GEOGRAPHICAL_AREA__MAILMEN:
        return getMailmen();
      case PostalPackage.GEOGRAPHICAL_AREA__INHABITANTS:
        return getInhabitants();
      case PostalPackage.GEOGRAPHICAL_AREA__ALL_MAILS:
        return getAllMails();
    }
    return super.eGet(featureID, resolve, coreType);
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @SuppressWarnings("unchecked")
  @Override
  public void eSet(int featureID, Object newValue)
  {
    switch (featureID)
    {
      case PostalPackage.GEOGRAPHICAL_AREA__MAILMEN:
        getMailmen().clear();
        getMailmen().addAll((Collection<? extends Mailman>)newValue);
        return;
      case PostalPackage.GEOGRAPHICAL_AREA__INHABITANTS:
        getInhabitants().clear();
        getInhabitants().addAll((Collection<? extends Inhabitant>)newValue);
        return;
      case PostalPackage.GEOGRAPHICAL_AREA__ALL_MAILS:
        getAllMails().clear();
        getAllMails().addAll((Collection<? extends RegisteredMail>)newValue);
        return;
    }
    super.eSet(featureID, newValue);
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @Override
  public void eUnset(int featureID)
  {
    switch (featureID)
    {
      case PostalPackage.GEOGRAPHICAL_AREA__MAILMEN:
        getMailmen().clear();
        return;
      case PostalPackage.GEOGRAPHICAL_AREA__INHABITANTS:
        getInhabitants().clear();
        return;
      case PostalPackage.GEOGRAPHICAL_AREA__ALL_MAILS:
        getAllMails().clear();
        return;
    }
    super.eUnset(featureID);
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @Override
  public boolean eIsSet(int featureID)
  {
    switch (featureID)
    {
      case PostalPackage.GEOGRAPHICAL_AREA__MAILMEN:
        return mailmen != null && !mailmen.isEmpty();
      case PostalPackage.GEOGRAPHICAL_AREA__INHABITANTS:
        return inhabitants != null && !inhabitants.isEmpty();
      case PostalPackage.GEOGRAPHICAL_AREA__ALL_MAILS:
        return allMails != null && !allMails.isEmpty();
    }
    return super.eIsSet(featureID);
  }

} // GeographicalArea
