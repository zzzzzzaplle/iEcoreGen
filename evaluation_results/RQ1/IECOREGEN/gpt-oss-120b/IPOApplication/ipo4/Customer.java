/**
 * generated by Enhanced EcoreGen
 */
package edu.ipo;

import java.util.Collection;

import org.eclipse.emf.common.notify.Notification;
import org.eclipse.emf.common.notify.NotificationChain;

import org.eclipse.emf.common.util.EList;

import org.eclipse.emf.ecore.EClass;
import org.eclipse.emf.ecore.EObject;
import org.eclipse.emf.ecore.InternalEObject;

import org.eclipse.emf.ecore.impl.ENotificationImpl;
import org.eclipse.emf.ecore.impl.MinimalEObjectImpl;

import org.eclipse.emf.ecore.util.EObjectContainmentWithInverseEList;
import org.eclipse.emf.ecore.util.InternalEList;
import edu.ipo.IpoFactory;
import edu.ipo.Application;
import edu.ipo.ApplicationStatus;
import edu.ipo.Company;
import edu.ipo.Document;


/**
 * <!-- begin-user-doc -->
 * A representation of the model object '<em><b>Customer</b></em>'.
 * <!-- end-user-doc -->
 *
 * <p>
 * The following features are supported:
 * </p>
 * <ul>
 *   <li>{@link edu.ipo.Customer#getName <em>Name</em>}</li>
 *   <li>{@link edu.ipo.Customer#getSurname <em>Surname</em>}</li>
 *   <li>{@link edu.ipo.Customer#getEmail <em>Email</em>}</li>
 *   <li>{@link edu.ipo.Customer#getTelephone <em>Telephone</em>}</li>
 *   <li>{@link edu.ipo.Customer#isCanApplyForIPO <em>Can Apply For IPO</em>}</li>
 *   <li>{@link edu.ipo.Customer#getApplications <em>Applications</em>}</li>
 * </ul>
 *
 * @see edu.ipo.IpoPackage#getCustomer()
 * @model kind="class"
 * @generated
 */
public class Customer extends MinimalEObjectImpl.Container implements EObject
{
  /**
   * The default value of the '{@link #getName() <em>Name</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getName()
   * @generated
   * @ordered
   */
  protected static final String NAME_EDEFAULT = null;

  /**
   * The cached value of the '{@link #getName() <em>Name</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getName()
   * @generated
   * @ordered
   */
  protected String name = NAME_EDEFAULT;

  /**
   * The default value of the '{@link #getSurname() <em>Surname</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getSurname()
   * @generated
   * @ordered
   */
  protected static final String SURNAME_EDEFAULT = null;

  /**
   * The cached value of the '{@link #getSurname() <em>Surname</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getSurname()
   * @generated
   * @ordered
   */
  protected String surname = SURNAME_EDEFAULT;

  /**
   * The default value of the '{@link #getEmail() <em>Email</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getEmail()
   * @generated
   * @ordered
   */
  protected static final String EMAIL_EDEFAULT = null;

  /**
   * The cached value of the '{@link #getEmail() <em>Email</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getEmail()
   * @generated
   * @ordered
   */
  protected String email = EMAIL_EDEFAULT;

  /**
   * The default value of the '{@link #getTelephone() <em>Telephone</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getTelephone()
   * @generated
   * @ordered
   */
  protected static final String TELEPHONE_EDEFAULT = null;

  /**
   * The cached value of the '{@link #getTelephone() <em>Telephone</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getTelephone()
   * @generated
   * @ordered
   */
  protected String telephone = TELEPHONE_EDEFAULT;

  /**
   * The default value of the '{@link #isCanApplyForIPO() <em>Can Apply For IPO</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #isCanApplyForIPO()
   * @generated
   * @ordered
   */
  protected static final boolean CAN_APPLY_FOR_IPO_EDEFAULT = false;

  /**
   * The cached value of the '{@link #isCanApplyForIPO() <em>Can Apply For IPO</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #isCanApplyForIPO()
   * @generated
   * @ordered
   */
  protected boolean canApplyForIPO = CAN_APPLY_FOR_IPO_EDEFAULT;

  /**
   * The cached value of the '{@link #getApplications() <em>Applications</em>}' containment reference list.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getApplications()
   * @generated
   * @ordered
   */
  protected EList<Application> applications;

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  protected Customer()
  {
    super();
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @Override
  protected EClass eStaticClass()
  {
    return IpoPackage.Literals.CUSTOMER;
  }

  /**
   * Returns the value of the '<em><b>Name</b></em>' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @return the value of the '<em>Name</em>' attribute.
   * @see #setName(String)
   * @see edu.ipo.IpoPackage#getCustomer_Name()
   * @model
   * @generated
   */
  public String getName()
  {
    return name;
  }

  /**
   * Sets the value of the '{@link edu.ipo.Customer#getName <em>Name</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @param newName the new value of the '<em>Name</em>' attribute.
   * @see #getName()
   * @generated
   */
  public void setName(String newName)
  {
    String oldName = name;
    name = newName;
    if (eNotificationRequired())
      eNotify(new ENotificationImpl(this, Notification.SET, IpoPackage.CUSTOMER__NAME, oldName, name));
  }

  /**
   * Returns the value of the '<em><b>Surname</b></em>' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @return the value of the '<em>Surname</em>' attribute.
   * @see #setSurname(String)
   * @see edu.ipo.IpoPackage#getCustomer_Surname()
   * @model
   * @generated
   */
  public String getSurname()
  {
    return surname;
  }

  /**
   * Sets the value of the '{@link edu.ipo.Customer#getSurname <em>Surname</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @param newSurname the new value of the '<em>Surname</em>' attribute.
   * @see #getSurname()
   * @generated
   */
  public void setSurname(String newSurname)
  {
    String oldSurname = surname;
    surname = newSurname;
    if (eNotificationRequired())
      eNotify(new ENotificationImpl(this, Notification.SET, IpoPackage.CUSTOMER__SURNAME, oldSurname, surname));
  }

  /**
   * Returns the value of the '<em><b>Email</b></em>' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @return the value of the '<em>Email</em>' attribute.
   * @see #setEmail(String)
   * @see edu.ipo.IpoPackage#getCustomer_Email()
   * @model
   * @generated
   */
  public String getEmail()
  {
    return email;
  }

  /**
   * Sets the value of the '{@link edu.ipo.Customer#getEmail <em>Email</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @param newEmail the new value of the '<em>Email</em>' attribute.
   * @see #getEmail()
   * @generated
   */
  public void setEmail(String newEmail)
  {
    String oldEmail = email;
    email = newEmail;
    if (eNotificationRequired())
      eNotify(new ENotificationImpl(this, Notification.SET, IpoPackage.CUSTOMER__EMAIL, oldEmail, email));
  }

  /**
   * Returns the value of the '<em><b>Telephone</b></em>' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @return the value of the '<em>Telephone</em>' attribute.
   * @see #setTelephone(String)
   * @see edu.ipo.IpoPackage#getCustomer_Telephone()
   * @model
   * @generated
   */
  public String getTelephone()
  {
    return telephone;
  }

  /**
   * Sets the value of the '{@link edu.ipo.Customer#getTelephone <em>Telephone</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @param newTelephone the new value of the '<em>Telephone</em>' attribute.
   * @see #getTelephone()
   * @generated
   */
  public void setTelephone(String newTelephone)
  {
    String oldTelephone = telephone;
    telephone = newTelephone;
    if (eNotificationRequired())
      eNotify(new ENotificationImpl(this, Notification.SET, IpoPackage.CUSTOMER__TELEPHONE, oldTelephone, telephone));
  }

  /**
   * Returns the value of the '<em><b>Can Apply For IPO</b></em>' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @return the value of the '<em>Can Apply For IPO</em>' attribute.
   * @see #setCanApplyForIPO(boolean)
   * @see edu.ipo.IpoPackage#getCustomer_CanApplyForIPO()
   * @model
   * @generated
   */
  public boolean isCanApplyForIPO()
  {
    return canApplyForIPO;
  }

  /**
   * Sets the value of the '{@link edu.ipo.Customer#isCanApplyForIPO <em>Can Apply For IPO</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @param newCanApplyForIPO the new value of the '<em>Can Apply For IPO</em>' attribute.
   * @see #isCanApplyForIPO()
   * @generated
   */
  public void setCanApplyForIPO(boolean newCanApplyForIPO)
  {
    boolean oldCanApplyForIPO = canApplyForIPO;
    canApplyForIPO = newCanApplyForIPO;
    if (eNotificationRequired())
      eNotify(new ENotificationImpl(this, Notification.SET, IpoPackage.CUSTOMER__CAN_APPLY_FOR_IPO, oldCanApplyForIPO, canApplyForIPO));
  }

  /**
   * Returns the value of the '<em><b>Applications</b></em>' containment reference list.
   * The list contents are of type {@link edu.ipo.Application}.
   * It is bidirectional and its opposite is '{@link edu.ipo.Application#getCustomer <em>Customer</em>}'.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @return the value of the '<em>Applications</em>' containment reference list.
   * @see edu.ipo.IpoPackage#getCustomer_Applications()
   * @see edu.ipo.Application#getCustomer
   * @model opposite="customer" containment="true"
   * @generated
   */
  public EList<Application> getApplications()
  {
    if (applications == null)
    {
      applications = new EObjectContainmentWithInverseEList<Application>(Application.class, this, IpoPackage.CUSTOMER__APPLICATIONS, IpoPackage.APPLICATION__CUSTOMER);
    }
    return applications;
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * <!-- begin-model-doc -->
   * Summary:
   *   Creates a new IPO application for a retail customer if the customer is
   *   eligible, has not already an approved application for the same company,
   *   and all supplied data are valid.
   * Algorithm:
   *   1. IF canApplyForIPO = false THEN return false.
   *   2. IF shares ≤ 0 OR amount ≤ 0.0 THEN return false.
   *   3. IF doc = null THEN return false.
   *   4. FOR each app IN applications
   *        IF app.company.name = company.name AND app.status = ApplicationStatus.APPROVAL
   *            THEN return false.   // duplicate approved application
   *   5. CREATE newApp ← new Application()
   *        newApp.company ← company
   *        newApp.customer ← this
   *        newApp.share ← shares
   *        newApp.amountOfMoney ← amount
   *        newApp.allowance ← doc
   *        newApp.status ← ApplicationStatus.PENDING
   *        newApp.emails ← empty list
   *   6. ADD newApp to this.applications.
   *   7. RETURN true.
   * Input:
   *   - company : Company            // target company, must be non‑null
   *   - shares  : int                // number of shares, must be > 0
   *   - amount  : double             // money to be paid, must be > 0.0
   *   - doc     : Document            // uploaded allowance document, non‑null
   * Output:
   *   Boolean – true if the application record is created, false otherwise.
   * Preconditions:
   *   - The Customer instance exists.
   *   - canApplyForIPO = true.
   * Postconditions:
   *   - A new Application object with status PENDING is stored in
   *     this.applications.
   * <!-- end-model-doc -->
   * @model annotation="http://www.ustb.edu.cn/sei/mde/EnhancedCodeGen generated='true'"
   * @generated NOT
   */
  public boolean createApplication(final Company company, final int shares, final double amount, final Document doc)
  {
    // 1. Check eligibility
    if (!isCanApplyForIPO()) {
      return false;
    }
    // 2. Validate numeric inputs
    if (shares <= 0 || amount <= 0.0) {
      return false;
    }
    // 3. Validate document
    if (doc == null) {
      return false;
    }
    // 4. Prevent duplicate approved application for the same company
    for (Application app : getApplications()) {
      if (app.getCompany() != null && company != null
          && company.getName().equals(app.getCompany().getName())
          && app.getStatus() == ApplicationStatus.APPROVAL) {
        return false;
      }
    }
    // 5. Create and initialise a new Application instance
    Application newApp = IpoFactory.eINSTANCE.createApplication();
    newApp.setCompany(company);
    newApp.setCustomer(this);
    newApp.setShare(shares);
    newApp.setAmountOfMoney(amount);
    newApp.setAllowance(doc);
    newApp.setStatus(ApplicationStatus.PENDING);
    // Emails list is initially empty; no explicit action required

    // 6. Add the new application to the customer's collection
    getApplications().add(newApp);

    // 7. Indicate successful creation
    return true;
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * <!-- begin-model-doc -->
   * Summary:
   *   Returns the total number of IPO applications that have been reviewed
   *   (approved or rejected) for this customer.
   * Algorithm:
   *   1. SET count ← 0.
   *   2. FOR each app IN applications
   *        IF app.status = ApplicationStatus.APPROVAL OR app.status = ApplicationStatus.REJECTED
   *            THEN count ← count + 1.
   *   3. RETURN count.
   * Input:
   *   (none)
   * Output:
   *   int – number of reviewed applications; 0 if none.
   * Preconditions:
   *   - The Customer instance exists.
   * Postconditions:
   *   - No change to the object's state.
   * <!-- end-model-doc -->
   * @model kind="operation"
   *        annotation="http://www.ustb.edu.cn/sei/mde/EnhancedCodeGen generated='true'"
   * @generated NOT
   */
  public int getApplicationCount()
  {
    int count = 0;
    for (Application app : getApplications()) {
      ApplicationStatus status = app.getStatus();
      if (status == ApplicationStatus.APPROVAL || status == ApplicationStatus.REJECTED) {
        count++;
      }
    }
    return count;
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * <!-- begin-model-doc -->
   * Summary:
   *   Calculates the aggregate amount of money for all approved IPO applications
   *   of this customer.
   * Algorithm:
   *   1. SET total ← 0.0.
   *   2. FOR each app IN applications
   *        IF app.status = ApplicationStatus.APPROVAL
   *            THEN total ← total + app.amountOfMoney.
   *   3. RETURN total.
   * Input:
   *   (none)
   * Output:
   *   double – sum of amountOfMoney of approved applications; 0.0 if none.
   * Preconditions:
   *   - The Customer instance exists.
   * Postconditions:
   *   - No modification of state.
   * <!-- end-model-doc -->
   * @model kind="operation"
   *        annotation="http://www.ustb.edu.cn/sei/mde/EnhancedCodeGen generated='true'"
   * @generated NOT
   */
  public double getApprovedTotalAmount()
  {
    double total = 0.0;
    for (Application app : getApplications()) {
      if (app.getStatus() == ApplicationStatus.APPROVAL) {
        total += app.getAmountOfMoney();
      }
    }
    return total;
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * <!-- begin-model-doc -->
   * Summary:
   *   Cancels a pending application belonging to the customer for the given
   *   company name.
   * Algorithm:
   *   1. FOR each app IN applications
   *        IF app.company.name = companyName AND app.status = ApplicationStatus.PENDING
   *            THEN RETURN app.cancel().
   *   2. RETURN false.   // no matching pending application found
   * Input:
   *   - companyName : String   // exact name of the target company, non‑empty
   * Output:
   *   Boolean – true if a pending application was found and cancelled,
   *   false otherwise.
   * Preconditions:
   *   - The Customer instance exists.
   * Postconditions:
   *   - If a matching pending application existed, its status becomes REJECTED
   *     (treated as cancelled) and no email is sent.
   * <!-- end-model-doc -->
   * @model annotation="http://www.ustb.edu.cn/sei/mde/EnhancedCodeGen generated='true'"
   * @generated NOT
   */
  public boolean cancelApplication(final String companyName)
  {
    for (Application app : getApplications()) {
      if (app.getCompany() != null
          && companyName.equals(app.getCompany().getName())
          && app.getStatus() == ApplicationStatus.PENDING) {
        return app.cancel();
      }
    }
    return false;
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @SuppressWarnings("unchecked")
  @Override
  public NotificationChain eInverseAdd(InternalEObject otherEnd, int featureID, NotificationChain msgs)
  {
    switch (featureID)
    {
      case IpoPackage.CUSTOMER__APPLICATIONS:
        return ((InternalEList<InternalEObject>)(InternalEList<?>)getApplications()).basicAdd(otherEnd, msgs);
    }
    return super.eInverseAdd(otherEnd, featureID, msgs);
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @Override
  public NotificationChain eInverseRemove(InternalEObject otherEnd, int featureID, NotificationChain msgs)
  {
    switch (featureID)
    {
      case IpoPackage.CUSTOMER__APPLICATIONS:
        return ((InternalEList<?>)getApplications()).basicRemove(otherEnd, msgs);
    }
    return super.eInverseRemove(otherEnd, featureID, msgs);
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @Override
  public Object eGet(int featureID, boolean resolve, boolean coreType)
  {
    switch (featureID)
    {
      case IpoPackage.CUSTOMER__NAME:
        return getName();
      case IpoPackage.CUSTOMER__SURNAME:
        return getSurname();
      case IpoPackage.CUSTOMER__EMAIL:
        return getEmail();
      case IpoPackage.CUSTOMER__TELEPHONE:
        return getTelephone();
      case IpoPackage.CUSTOMER__CAN_APPLY_FOR_IPO:
        return isCanApplyForIPO();
      case IpoPackage.CUSTOMER__APPLICATIONS:
        return getApplications();
    }
    return super.eGet(featureID, resolve, coreType);
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @SuppressWarnings("unchecked")
  @Override
  public void eSet(int featureID, Object newValue)
  {
    switch (featureID)
    {
      case IpoPackage.CUSTOMER__NAME:
        setName((String)newValue);
        return;
      case IpoPackage.CUSTOMER__SURNAME:
        setSurname((String)newValue);
        return;
      case IpoPackage.CUSTOMER__EMAIL:
        setEmail((String)newValue);
        return;
      case IpoPackage.CUSTOMER__TELEPHONE:
        setTelephone((String)newValue);
        return;
      case IpoPackage.CUSTOMER__CAN_APPLY_FOR_IPO:
        setCanApplyForIPO((Boolean)newValue);
        return;
      case IpoPackage.CUSTOMER__APPLICATIONS:
        getApplications().clear();
        getApplications().addAll((Collection<? extends Application>)newValue);
        return;
    }
    super.eSet(featureID, newValue);
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @Override
  public void eUnset(int featureID)
  {
    switch (featureID)
    {
      case IpoPackage.CUSTOMER__NAME:
        setName(NAME_EDEFAULT);
        return;
      case IpoPackage.CUSTOMER__SURNAME:
        setSurname(SURNAME_EDEFAULT);
        return;
      case IpoPackage.CUSTOMER__EMAIL:
        setEmail(EMAIL_EDEFAULT);
        return;
      case IpoPackage.CUSTOMER__TELEPHONE:
        setTelephone(TELEPHONE_EDEFAULT);
        return;
      case IpoPackage.CUSTOMER__CAN_APPLY_FOR_IPO:
        setCanApplyForIPO(CAN_APPLY_FOR_IPO_EDEFAULT);
        return;
      case IpoPackage.CUSTOMER__APPLICATIONS:
        getApplications().clear();
        return;
    }
    super.eUnset(featureID);
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @Override
  public boolean eIsSet(int featureID)
  {
    switch (featureID)
    {
      case IpoPackage.CUSTOMER__NAME:
        return NAME_EDEFAULT == null ? name != null : !NAME_EDEFAULT.equals(name);
      case IpoPackage.CUSTOMER__SURNAME:
        return SURNAME_EDEFAULT == null ? surname != null : !SURNAME_EDEFAULT.equals(surname);
      case IpoPackage.CUSTOMER__EMAIL:
        return EMAIL_EDEFAULT == null ? email != null : !EMAIL_EDEFAULT.equals(email);
      case IpoPackage.CUSTOMER__TELEPHONE:
        return TELEPHONE_EDEFAULT == null ? telephone != null : !TELEPHONE_EDEFAULT.equals(telephone);
      case IpoPackage.CUSTOMER__CAN_APPLY_FOR_IPO:
        return canApplyForIPO != CAN_APPLY_FOR_IPO_EDEFAULT;
      case IpoPackage.CUSTOMER__APPLICATIONS:
        return applications != null && !applications.isEmpty();
    }
    return super.eIsSet(featureID);
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @Override
  public String toString()
  {
    if (eIsProxy()) return super.toString();

    StringBuilder result = new StringBuilder(super.toString());
    result.append(" (name: ");
    result.append(name);
    result.append(", surname: ");
    result.append(surname);
    result.append(", email: ");
    result.append(email);
    result.append(", telephone: ");
    result.append(telephone);
    result.append(", canApplyForIPO: ");
    result.append(canApplyForIPO);
    result.append(')');
    return result.toString();
  }

  /** @LLM */ public void voidName(String newName)
  { /* omitted */ }

} // Customer
