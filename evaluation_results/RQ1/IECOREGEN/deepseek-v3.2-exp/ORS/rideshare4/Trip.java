/**
 * generated by Enhanced EcoreGen
 */
package edu.rideshare;

import java.util.Collection;
import java.util.Date;

import org.eclipse.emf.common.notify.Notification;
import org.eclipse.emf.common.notify.NotificationChain;

import org.eclipse.emf.common.util.EList;

import org.eclipse.emf.ecore.EClass;
import org.eclipse.emf.ecore.EObject;
import org.eclipse.emf.ecore.InternalEObject;

import org.eclipse.emf.ecore.impl.ENotificationImpl;
import org.eclipse.emf.ecore.impl.MinimalEObjectImpl;

import org.eclipse.emf.ecore.util.EObjectContainmentWithInverseEList;
import org.eclipse.emf.ecore.util.EcoreUtil;
import org.eclipse.emf.ecore.util.InternalEList;
import java.text.SimpleDateFormat;
import java.text.ParseException;
import org.eclipse.emf.common.util.BasicEList;

/**
 * <!-- begin-user-doc -->
 * A representation of the model object '<em><b>Trip</b></em>'.
 * <!-- end-user-doc -->
 *
 * <p>
 * The following features are supported:
 * </p>
 * <ul>
 *   <li>{@link edu.rideshare.Trip#getDepartureStation <em>Departure Station</em>}</li>
 *   <li>{@link edu.rideshare.Trip#getArrivalStation <em>Arrival Station</em>}</li>
 *   <li>{@link edu.rideshare.Trip#getDepartureTime <em>Departure Time</em>}</li>
 *   <li>{@link edu.rideshare.Trip#getArrivalTime <em>Arrival Time</em>}</li>
 *   <li>{@link edu.rideshare.Trip#getNumberOfSeats <em>Number Of Seats</em>}</li>
 *   <li>{@link edu.rideshare.Trip#getDepartureDate <em>Departure Date</em>}</li>
 *   <li>{@link edu.rideshare.Trip#getPrice <em>Price</em>}</li>
 *   <li>{@link edu.rideshare.Trip#getBookings <em>Bookings</em>}</li>
 *   <li>{@link edu.rideshare.Trip#getStops <em>Stops</em>}</li>
 *   <li>{@link edu.rideshare.Trip#getDriver <em>Driver</em>}</li>
 * </ul>
 *
 * @see edu.rideshare.RidesharePackage#getTrip()
 * @model kind="class"
 * @generated
 */
public class Trip extends MinimalEObjectImpl.Container implements EObject
{
  /**
   * The default value of the '{@link #getDepartureStation() <em>Departure Station</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getDepartureStation()
   * @generated
   * @ordered
   */
  protected static final String DEPARTURE_STATION_EDEFAULT = null;

  /**
   * The cached value of the '{@link #getDepartureStation() <em>Departure Station</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getDepartureStation()
   * @generated
   * @ordered
   */
  protected String departureStation = DEPARTURE_STATION_EDEFAULT;

  /**
   * The default value of the '{@link #getArrivalStation() <em>Arrival Station</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getArrivalStation()
   * @generated
   * @ordered
   */
  protected static final String ARRIVAL_STATION_EDEFAULT = null;

  /**
   * The cached value of the '{@link #getArrivalStation() <em>Arrival Station</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getArrivalStation()
   * @generated
   * @ordered
   */
  protected String arrivalStation = ARRIVAL_STATION_EDEFAULT;

  /**
   * The default value of the '{@link #getDepartureTime() <em>Departure Time</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getDepartureTime()
   * @generated
   * @ordered
   */
  protected static final String DEPARTURE_TIME_EDEFAULT = null;

  /**
   * The cached value of the '{@link #getDepartureTime() <em>Departure Time</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getDepartureTime()
   * @generated
   * @ordered
   */
  protected String departureTime = DEPARTURE_TIME_EDEFAULT;

  /**
   * The default value of the '{@link #getArrivalTime() <em>Arrival Time</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getArrivalTime()
   * @generated
   * @ordered
   */
  protected static final String ARRIVAL_TIME_EDEFAULT = null;

  /**
   * The cached value of the '{@link #getArrivalTime() <em>Arrival Time</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getArrivalTime()
   * @generated
   * @ordered
   */
  protected String arrivalTime = ARRIVAL_TIME_EDEFAULT;

  /**
   * The default value of the '{@link #getNumberOfSeats() <em>Number Of Seats</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getNumberOfSeats()
   * @generated
   * @ordered
   */
  protected static final int NUMBER_OF_SEATS_EDEFAULT = 0;

  /**
   * The cached value of the '{@link #getNumberOfSeats() <em>Number Of Seats</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getNumberOfSeats()
   * @generated
   * @ordered
   */
  protected int numberOfSeats = NUMBER_OF_SEATS_EDEFAULT;

  /**
   * The default value of the '{@link #getDepartureDate() <em>Departure Date</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getDepartureDate()
   * @generated
   * @ordered
   */
  protected static final Date DEPARTURE_DATE_EDEFAULT = null;

  /**
   * The cached value of the '{@link #getDepartureDate() <em>Departure Date</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getDepartureDate()
   * @generated
   * @ordered
   */
  protected Date departureDate = DEPARTURE_DATE_EDEFAULT;

  /**
   * The default value of the '{@link #getPrice() <em>Price</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getPrice()
   * @generated
   * @ordered
   */
  protected static final double PRICE_EDEFAULT = 0.0;

  /**
   * The cached value of the '{@link #getPrice() <em>Price</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getPrice()
   * @generated
   * @ordered
   */
  protected double price = PRICE_EDEFAULT;

  /**
   * The cached value of the '{@link #getBookings() <em>Bookings</em>}' containment reference list.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getBookings()
   * @generated
   * @ordered
   */
  protected EList<Booking> bookings;

  /**
   * The cached value of the '{@link #getStops() <em>Stops</em>}' containment reference list.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @see #getStops()
   * @generated
   * @ordered
   */
  protected EList<Stop> stops;

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  protected Trip()
  {
    super();
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @Override
  protected EClass eStaticClass()
  {
    return RidesharePackage.Literals.TRIP;
  }

  /**
   * Returns the value of the '<em><b>Departure Station</b></em>' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @return the value of the '<em>Departure Station</em>' attribute.
   * @see #setDepartureStation(String)
   * @see edu.rideshare.RidesharePackage#getTrip_DepartureStation()
   * @model
   * @generated
   */
  public String getDepartureStation()
  {
    return departureStation;
  }

  /**
   * Sets the value of the '{@link edu.rideshare.Trip#getDepartureStation <em>Departure Station</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @param newDepartureStation the new value of the '<em>Departure Station</em>' attribute.
   * @see #getDepartureStation()
   * @generated
   */
  public void setDepartureStation(String newDepartureStation)
  {
    String oldDepartureStation = departureStation;
    departureStation = newDepartureStation;
    if (eNotificationRequired())
      eNotify(new ENotificationImpl(this, Notification.SET, RidesharePackage.TRIP__DEPARTURE_STATION, oldDepartureStation, departureStation));
  }

  /**
   * Returns the value of the '<em><b>Arrival Station</b></em>' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @return the value of the '<em>Arrival Station</em>' attribute.
   * @see #setArrivalStation(String)
   * @see edu.rideshare.RidesharePackage#getTrip_ArrivalStation()
   * @model
   * @generated
   */
  public String getArrivalStation()
  {
    return arrivalStation;
  }

  /**
   * Sets the value of the '{@link edu.rideshare.Trip#getArrivalStation <em>Arrival Station</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @param newArrivalStation the new value of the '<em>Arrival Station</em>' attribute.
   * @see #getArrivalStation()
   * @generated
   */
  public void setArrivalStation(String newArrivalStation)
  {
    String oldArrivalStation = arrivalStation;
    arrivalStation = newArrivalStation;
    if (eNotificationRequired())
      eNotify(new ENotificationImpl(this, Notification.SET, RidesharePackage.TRIP__ARRIVAL_STATION, oldArrivalStation, arrivalStation));
  }

  /**
   * Returns the value of the '<em><b>Departure Time</b></em>' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @return the value of the '<em>Departure Time</em>' attribute.
   * @see #setDepartureTime(String)
   * @see edu.rideshare.RidesharePackage#getTrip_DepartureTime()
   * @model
   * @generated
   */
  public String getDepartureTime()
  {
    return departureTime;
  }

  /**
   * Sets the value of the '{@link edu.rideshare.Trip#getDepartureTime <em>Departure Time</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @param newDepartureTime the new value of the '<em>Departure Time</em>' attribute.
   * @see #getDepartureTime()
   * @generated
   */
  public void setDepartureTime(String newDepartureTime)
  {
    String oldDepartureTime = departureTime;
    departureTime = newDepartureTime;
    if (eNotificationRequired())
      eNotify(new ENotificationImpl(this, Notification.SET, RidesharePackage.TRIP__DEPARTURE_TIME, oldDepartureTime, departureTime));
  }

  /**
   * Returns the value of the '<em><b>Arrival Time</b></em>' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @return the value of the '<em>Arrival Time</em>' attribute.
   * @see #setArrivalTime(String)
   * @see edu.rideshare.RidesharePackage#getTrip_ArrivalTime()
   * @model
   * @generated
   */
  public String getArrivalTime()
  {
    return arrivalTime;
  }

  /**
   * Sets the value of the '{@link edu.rideshare.Trip#getArrivalTime <em>Arrival Time</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @param newArrivalTime the new value of the '<em>Arrival Time</em>' attribute.
   * @see #getArrivalTime()
   * @generated
   */
  public void setArrivalTime(String newArrivalTime)
  {
    String oldArrivalTime = arrivalTime;
    arrivalTime = newArrivalTime;
    if (eNotificationRequired())
      eNotify(new ENotificationImpl(this, Notification.SET, RidesharePackage.TRIP__ARRIVAL_TIME, oldArrivalTime, arrivalTime));
  }

  /**
   * Returns the value of the '<em><b>Number Of Seats</b></em>' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @return the value of the '<em>Number Of Seats</em>' attribute.
   * @see #setNumberOfSeats(int)
   * @see edu.rideshare.RidesharePackage#getTrip_NumberOfSeats()
   * @model
   * @generated
   */
  public int getNumberOfSeats()
  {
    return numberOfSeats;
  }

  /**
   * Sets the value of the '{@link edu.rideshare.Trip#getNumberOfSeats <em>Number Of Seats</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @param newNumberOfSeats the new value of the '<em>Number Of Seats</em>' attribute.
   * @see #getNumberOfSeats()
   * @generated
   */
  public void setNumberOfSeats(int newNumberOfSeats)
  {
    int oldNumberOfSeats = numberOfSeats;
    numberOfSeats = newNumberOfSeats;
    if (eNotificationRequired())
      eNotify(new ENotificationImpl(this, Notification.SET, RidesharePackage.TRIP__NUMBER_OF_SEATS, oldNumberOfSeats, numberOfSeats));
  }

  /**
   * Returns the value of the '<em><b>Departure Date</b></em>' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @return the value of the '<em>Departure Date</em>' attribute.
   * @see #setDepartureDate(Date)
   * @see edu.rideshare.RidesharePackage#getTrip_DepartureDate()
   * @model
   * @generated
   */
  public Date getDepartureDate()
  {
    return departureDate;
  }

  /**
   * Sets the value of the '{@link edu.rideshare.Trip#getDepartureDate <em>Departure Date</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @param newDepartureDate the new value of the '<em>Departure Date</em>' attribute.
   * @see #getDepartureDate()
   * @generated
   */
  public void setDepartureDate(Date newDepartureDate)
  {
    Date oldDepartureDate = departureDate;
    departureDate = newDepartureDate;
    if (eNotificationRequired())
      eNotify(new ENotificationImpl(this, Notification.SET, RidesharePackage.TRIP__DEPARTURE_DATE, oldDepartureDate, departureDate));
  }

  /**
   * Returns the value of the '<em><b>Price</b></em>' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @return the value of the '<em>Price</em>' attribute.
   * @see #setPrice(double)
   * @see edu.rideshare.RidesharePackage#getTrip_Price()
   * @model
   * @generated
   */
  public double getPrice()
  {
    return price;
  }

  /**
   * Sets the value of the '{@link edu.rideshare.Trip#getPrice <em>Price</em>}' attribute.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @param newPrice the new value of the '<em>Price</em>' attribute.
   * @see #getPrice()
   * @generated
   */
  public void setPrice(double newPrice)
  {
    double oldPrice = price;
    price = newPrice;
    if (eNotificationRequired())
      eNotify(new ENotificationImpl(this, Notification.SET, RidesharePackage.TRIP__PRICE, oldPrice, price));
  }

  /**
   * Returns the value of the '<em><b>Bookings</b></em>' containment reference list.
   * The list contents are of type {@link edu.rideshare.Booking}.
   * It is bidirectional and its opposite is '{@link edu.rideshare.Booking#getTrip <em>Trip</em>}'.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @return the value of the '<em>Bookings</em>' containment reference list.
   * @see edu.rideshare.RidesharePackage#getTrip_Bookings()
   * @see edu.rideshare.Booking#getTrip
   * @model opposite="trip" containment="true"
   * @generated
   */
  public EList<Booking> getBookings()
  {
    if (bookings == null)
    {
      bookings = new EObjectContainmentWithInverseEList<Booking>(Booking.class, this, RidesharePackage.TRIP__BOOKINGS, RidesharePackage.BOOKING__TRIP);
    }
    return bookings;
  }

  /**
   * Returns the value of the '<em><b>Stops</b></em>' containment reference list.
   * The list contents are of type {@link edu.rideshare.Stop}.
   * It is bidirectional and its opposite is '{@link edu.rideshare.Stop#getTrip <em>Trip</em>}'.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @return the value of the '<em>Stops</em>' containment reference list.
   * @see edu.rideshare.RidesharePackage#getTrip_Stops()
   * @see edu.rideshare.Stop#getTrip
   * @model opposite="trip" containment="true"
   * @generated
   */
  public EList<Stop> getStops()
  {
    if (stops == null)
    {
      stops = new EObjectContainmentWithInverseEList<Stop>(Stop.class, this, RidesharePackage.TRIP__STOPS, RidesharePackage.STOP__TRIP);
    }
    return stops;
  }

  /**
   * Returns the value of the '<em><b>Driver</b></em>' container reference.
   * It is bidirectional and its opposite is '{@link edu.rideshare.Driver#getTrips <em>Trips</em>}'.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @return the value of the '<em>Driver</em>' container reference.
   * @see #setDriver(Driver)
   * @see edu.rideshare.RidesharePackage#getTrip_Driver()
   * @see edu.rideshare.Driver#getTrips
   * @model opposite="trips" required="true" transient="false"
   * @generated
   */
  public Driver getDriver()
  {
    if (eContainerFeatureID() != RidesharePackage.TRIP__DRIVER) return null;
    return (Driver)eInternalContainer();
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  public NotificationChain basicSetDriver(Driver newDriver, NotificationChain msgs)
  {
    msgs = eBasicSetContainer(newDriver, RidesharePackage.TRIP__DRIVER, msgs);
    return msgs;
  }

  /**
   * Sets the value of the '{@link edu.rideshare.Trip#getDriver <em>Driver</em>}' container reference.
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @param newDriver the new value of the '<em>Driver</em>' container reference.
   * @see #getDriver()
   * @generated
   */
  public void setDriver(Driver newDriver)
  {
    if (newDriver != eInternalContainer() || (eContainerFeatureID() != RidesharePackage.TRIP__DRIVER && newDriver != null))
    {
      if (EcoreUtil.isAncestor(this, newDriver))
        throw new IllegalArgumentException("Recursive containment not allowed for " + toString());
      NotificationChain msgs = null;
      if (eInternalContainer() != null)
        msgs = eBasicRemoveFromContainer(msgs);
      if (newDriver != null)
        msgs = newDriver.eInverseAdd(this, RidesharePackage.DRIVER__TRIPS, Driver.class, msgs);
      msgs = basicSetDriver(newDriver, msgs);
      if (msgs != null) msgs.dispatch();
    }
    else if (eNotificationRequired())
      eNotify(new ENotificationImpl(this, Notification.SET, RidesharePackage.TRIP__DRIVER, newDriver, newDriver));
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * <!-- begin-model-doc -->
   * Summary: Calculates discounted price for a customer based on membership and timing
   * Algorithm:
   *   1. Get base price from trip.price
   *   2. Apply membership discounts if customer has DISCOUNTS award
   *   3. Apply early booking discount based on bookingTime vs departureDate
   *   4. Return final discounted price
   * Input:
   *   - customer: Customer object for membership checking
   *   - bookingTime: String representing booking time in "YYYY-MM-DD HH:MM" format
   * Output: double - final discounted price (>= 0)
   * Pre-condition: Customer and bookingTime must be valid
   * Post-condition: None (read-only operation)
   * <!-- end-model-doc -->
   * @model annotation="http://www.ustb.edu.cn/sei/mde/EnhancedCodeGen generated='true'"
   * @generated NOT
   */
  public double calculateDiscountedPrice(final Customer customer, final String bookingTime)
  {
    double discountedPrice = price;
    
    // Apply membership discount if customer has membership package
    if (customer != null && customer.getMembershipPackage() != null) {
      // Customer has a membership package, apply discount
      discountedPrice *= 0.9; // 10% discount for members
    }
    
    // Apply early booking discount
    try {
      SimpleDateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd HH:mm");
      Date bookingDate = dateFormat.parse(bookingTime);
      long timeDiff = departureDate.getTime() - bookingDate.getTime();
      long daysDiff = timeDiff / (1000 * 60 * 60 * 24);
      
      if (daysDiff >= 30) {
        discountedPrice *= 0.85; // 15% early booking discount
      } else if (daysDiff >= 14) {
        discountedPrice *= 0.9; // 10% early booking discount
      } else if (daysDiff >= 7) {
        discountedPrice *= 0.95; // 5% early booking discount
      }
    } catch (ParseException e) {
      // If parsing fails, no early booking discount applied
    }
    
    // Ensure price doesn't go below 0
    return Math.max(discountedPrice, 0.0);
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * <!-- begin-model-doc -->
   * Summary: Calculates points earned for this trip in the specified month
   * Algorithm:
   *   1. Check if trip departure date falls in currentMonth
   *   2. Calculate base points from trip price (e.g., 1 point per $10)
   *   3. Apply membership multipliers if customer has POINTS award
   *   4. Return calculated points
   * Input:
   *   - customer: Customer object for membership benefits
   *   - currentMonth: String in "YYYY-MM" format
   * Output: int - points earned (>= 0)
   * Pre-condition: currentMonth must be valid format
   * Post-condition: None (read-only operation)
   * <!-- end-model-doc -->
   * @model annotation="http://www.ustb.edu.cn/sei/mde/EnhancedCodeGen generated='true'"
   * @generated NOT
   */
  public int calculateMonthlyPoints(final Customer customer, final String currentMonth)
  {
    // Check if trip departure date falls in currentMonth
    if (departureDate == null) {
      return 0;
    }
    
    SimpleDateFormat monthFormat = new SimpleDateFormat("yyyy-MM");
    String tripMonth = monthFormat.format(departureDate);
    
    if (!tripMonth.equals(currentMonth)) {
      return 0;
    }
    
    // Calculate base points (1 point per $10)
    int basePoints = (int) (price / 10);
    
    // Apply membership multiplier if customer has membership package
    if (customer != null && customer.getMembershipPackage() != null) {
      basePoints *= 2; // Double points for members
    }
    
    return Math.max(basePoints, 0);
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * <!-- begin-model-doc -->
   * Summary: Attempts to book the specified number of seats on the trip
   * Algorithm:
   *   1. Check if num <= available seats (numberOfSeats)
   *   2. If available, reduce available seats by num
   *   3. Return true if successful, false if not enough seats
   * Input: num - integer representing number of seats to book (must be > 0)
   * Output: boolean - true if booking successful, false otherwise
   * Pre-condition: Trip must be active and have valid seat count
   * Post-condition: If successful, available seats are reduced
   * <!-- end-model-doc -->
   * @model annotation="http://www.ustb.edu.cn/sei/mde/EnhancedCodeGen generated='true'"
   * @generated NOT
   */
  public boolean bookSeats(final int num)
  {
    if (num <= 0) {
      return false;
    }
    
    if (num <= numberOfSeats) {
      numberOfSeats -= num;
      return true;
    }
    
    return false;
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * <!-- begin-model-doc -->
   * Summary: Confirms a booking by finalizing seat allocation
   * Algorithm:
   *   1. Check if seats are available using bookSeats(seats)
   *   2. If successful, create booking record
   *   3. Return true if confirmed, false if failed
   * Input: seats - integer number of seats to confirm (must be > 0)
   * Output: boolean - true if booking confirmed, false otherwise
   * Pre-condition: Trip must have sufficient available seats
   * Post-condition: If successful, seats are allocated and booking is recorded
   * <!-- end-model-doc -->
   * @model annotation="http://www.ustb.edu.cn/sei/mde/EnhancedCodeGen generated='true'"
   * @generated NOT
   */
  public boolean confirmBooking(final int seats)
  {
    if (bookSeats(seats)) {
      Booking booking = RideshareFactory.eINSTANCE.createBooking();
      booking.setNumberOfSeats(seats);
      booking.setTrip(this);
      getBookings().add(booking);
      return true;
    }
    
    return false;
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * <!-- begin-model-doc -->
   * Summary: Returns list of all stop stations for the trip
   * Algorithm:
   *   1. Extract stopStation from each Stop in stops list
   *   2. Return list of station names
   * Input: None
   * Output: List<String> - ordered list of stop station names
   * Pre-condition: stops list must be initialized
   * Post-condition: None (read-only operation)
   * <!-- end-model-doc -->
   * @model kind="operation"
   *        annotation="http://www.ustb.edu.cn/sei/mde/EnhancedCodeGen generated='true'"
   * @generated NOT
   */
  public EList<String> getStopStations()
  {
    EList<String> stopStations = new BasicEList<String>();
    
    if (stops != null) {
      for (Stop stop : stops) {
        if (stop.getStopStation() != null) {
          stopStations.add(stop.getStopStation());
        }
      }
    }
    
    return stopStations;
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * <!-- begin-model-doc -->
   * Summary: Checks if new time interval conflicts with this trip's schedule
   * Algorithm:
   *   1. Compare newDepartureTime and newArrivalTime with existing trip times
   *   2. Check if time intervals overlap
   *   3. Return true if conflict exists, false otherwise
   * Input:
   *   - newDepartureTime: String in "HH:MM" format
   *   - newArrivalTime: String in "HH:MM" format
   * Output: boolean - true if time conflict exists, false otherwise
   * Pre-condition: Time strings must be in valid format
   * Post-condition: None (read-only operation)
   * <!-- end-model-doc -->
   * @model annotation="http://www.ustb.edu.cn/sei/mde/EnhancedCodeGen generated='true'"
   * @generated NOT
   */
  public boolean isTimeConflicting(final String newDepartureTime, final String newArrivalTime)
  {
    try {
      SimpleDateFormat timeFormat = new SimpleDateFormat("HH:mm");
      
      Date newDeparture = timeFormat.parse(newDepartureTime);
      Date newArrival = timeFormat.parse(newArrivalTime);
      Date currentDeparture = timeFormat.parse(departureTime);
      Date currentArrival = timeFormat.parse(arrivalTime);
      
      // Check if time intervals overlap
      return !(newArrival.before(currentDeparture) || newDeparture.after(currentArrival));
    } catch (ParseException e) {
      // If parsing fails, assume no conflict
      return false;
    }
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @SuppressWarnings("unchecked")
  @Override
  public NotificationChain eInverseAdd(InternalEObject otherEnd, int featureID, NotificationChain msgs)
  {
    switch (featureID)
    {
      case RidesharePackage.TRIP__BOOKINGS:
        return ((InternalEList<InternalEObject>)(InternalEList<?>)getBookings()).basicAdd(otherEnd, msgs);
      case RidesharePackage.TRIP__STOPS:
        return ((InternalEList<InternalEObject>)(InternalEList<?>)getStops()).basicAdd(otherEnd, msgs);
      case RidesharePackage.TRIP__DRIVER:
        if (eInternalContainer() != null)
          msgs = eBasicRemoveFromContainer(msgs);
        return basicSetDriver((Driver)otherEnd, msgs);
    }
    return super.eInverseAdd(otherEnd, featureID, msgs);
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @Override
  public NotificationChain eInverseRemove(InternalEObject otherEnd, int featureID, NotificationChain msgs)
  {
    switch (featureID)
    {
      case RidesharePackage.TRIP__BOOKINGS:
        return ((InternalEList<?>)getBookings()).basicRemove(otherEnd, msgs);
      case RidesharePackage.TRIP__STOPS:
        return ((InternalEList<?>)getStops()).basicRemove(otherEnd, msgs);
      case RidesharePackage.TRIP__DRIVER:
        return basicSetDriver(null, msgs);
    }
    return super.eInverseRemove(otherEnd, featureID, msgs);
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @Override
  public NotificationChain eBasicRemoveFromContainerFeature(NotificationChain msgs)
  {
    switch (eContainerFeatureID())
    {
      case RidesharePackage.TRIP__DRIVER:
        return eInternalContainer().eInverseRemove(this, RidesharePackage.DRIVER__TRIPS, Driver.class, msgs);
    }
    return super.eBasicRemoveFromContainerFeature(msgs);
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @Override
  public Object eGet(int featureID, boolean resolve, boolean coreType)
  {
    switch (featureID)
    {
      case RidesharePackage.TRIP__DEPARTURE_STATION:
        return getDepartureStation();
      case RidesharePackage.TRIP__ARRIVAL_STATION:
        return getArrivalStation();
      case RidesharePackage.TRIP__DEPARTURE_TIME:
        return getDepartureTime();
      case RidesharePackage.TRIP__ARRIVAL_TIME:
        return getArrivalTime();
      case RidesharePackage.TRIP__NUMBER_OF_SEATS:
        return getNumberOfSeats();
      case RidesharePackage.TRIP__DEPARTURE_DATE:
        return getDepartureDate();
      case RidesharePackage.TRIP__PRICE:
        return getPrice();
      case RidesharePackage.TRIP__BOOKINGS:
        return getBookings();
      case RidesharePackage.TRIP__STOPS:
        return getStops();
      case RidesharePackage.TRIP__DRIVER:
        return getDriver();
    }
    return super.eGet(featureID, resolve, coreType);
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @SuppressWarnings("unchecked")
  @Override
  public void eSet(int featureID, Object newValue)
  {
    switch (featureID)
    {
      case RidesharePackage.TRIP__DEPARTURE_STATION:
        setDepartureStation((String)newValue);
        return;
      case RidesharePackage.TRIP__ARRIVAL_STATION:
        setArrivalStation((String)newValue);
        return;
      case RidesharePackage.TRIP__DEPARTURE_TIME:
        setDepartureTime((String)newValue);
        return;
      case RidesharePackage.TRIP__ARRIVAL_TIME:
        setArrivalTime((String)newValue);
        return;
      case RidesharePackage.TRIP__NUMBER_OF_SEATS:
        setNumberOfSeats((Integer)newValue);
        return;
      case RidesharePackage.TRIP__DEPARTURE_DATE:
        setDepartureDate((Date)newValue);
        return;
      case RidesharePackage.TRIP__PRICE:
        setPrice((Double)newValue);
        return;
      case RidesharePackage.TRIP__BOOKINGS:
        getBookings().clear();
        getBookings().addAll((Collection<? extends Booking>)newValue);
        return;
      case RidesharePackage.TRIP__STOPS:
        getStops().clear();
        getStops().addAll((Collection<? extends Stop>)newValue);
        return;
      case RidesharePackage.TRIP__DRIVER:
        setDriver((Driver)newValue);
        return;
    }
    super.eSet(featureID, newValue);
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @Override
  public void eUnset(int featureID)
  {
    switch (featureID)
    {
      case RidesharePackage.TRIP__DEPARTURE_STATION:
        setDepartureStation(DEPARTURE_STATION_EDEFAULT);
        return;
      case RidesharePackage.TRIP__ARRIVAL_STATION:
        setArrivalStation(ARRIVAL_STATION_EDEFAULT);
        return;
      case RidesharePackage.TRIP__DEPARTURE_TIME:
        setDepartureTime(DEPARTURE_TIME_EDEFAULT);
        return;
      case RidesharePackage.TRIP__ARRIVAL_TIME:
        setArrivalTime(ARRIVAL_TIME_EDEFAULT);
        return;
      case RidesharePackage.TRIP__NUMBER_OF_SEATS:
        setNumberOfSeats(NUMBER_OF_SEATS_EDEFAULT);
        return;
      case RidesharePackage.TRIP__DEPARTURE_DATE:
        setDepartureDate(DEPARTURE_DATE_EDEFAULT);
        return;
      case RidesharePackage.TRIP__PRICE:
        setPrice(PRICE_EDEFAULT);
        return;
      case RidesharePackage.TRIP__BOOKINGS:
        getBookings().clear();
        return;
      case RidesharePackage.TRIP__STOPS:
        getStops().clear();
        return;
      case RidesharePackage.TRIP__DRIVER:
        setDriver((Driver)null);
        return;
    }
    super.eUnset(featureID);
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @Override
  public boolean eIsSet(int featureID)
  {
    switch (featureID)
    {
      case RidesharePackage.TRIP__DEPARTURE_STATION:
        return DEPARTURE_STATION_EDEFAULT == null ? departureStation != null : !DEPARTURE_STATION_EDEFAULT.equals(departureStation);
      case RidesharePackage.TRIP__ARRIVAL_STATION:
        return ARRIVAL_STATION_EDEFAULT == null ? arrivalStation != null : !ARRIVAL_STATION_EDEFAULT.equals(arrivalStation);
      case RidesharePackage.TRIP__DEPARTURE_TIME:
        return DEPARTURE_TIME_EDEFAULT == null ? departureTime != null : !DEPARTURE_TIME_EDEFAULT.equals(departureTime);
      case RidesharePackage.TRIP__ARRIVAL_TIME:
        return ARRIVAL_TIME_EDEFAULT == null ? arrivalTime != null : !ARRIVAL_TIME_EDEFAULT.equals(arrivalTime);
      case RidesharePackage.TRIP__NUMBER_OF_SEATS:
        return numberOfSeats != NUMBER_OF_SEATS_EDEFAULT;
      case RidesharePackage.TRIP__DEPARTURE_DATE:
        return DEPARTURE_DATE_EDEFAULT == null ? departureDate != null : !DEPARTURE_DATE_EDEFAULT.equals(departureDate);
      case RidesharePackage.TRIP__PRICE:
        return price != PRICE_EDEFAULT;
      case RidesharePackage.TRIP__BOOKINGS:
        return bookings != null && !bookings.isEmpty();
      case RidesharePackage.TRIP__STOPS:
        return stops != null && !stops.isEmpty();
      case RidesharePackage.TRIP__DRIVER:
        return getDriver() != null;
    }
    return super.eIsSet(featureID);
  }

  /**
   * <!-- begin-user-doc -->
   * <!-- end-user-doc -->
   * @generated
   */
  @Override
  public String toString()
  {
    if (eIsProxy()) return super.toString();

    StringBuilder result = new StringBuilder(super.toString());
    result.append(" (departureStation: ");
    result.append(departureStation);
    result.append(", arrivalStation: ");
    result.append(arrivalStation);
    result.append(", departureTime: ");
    result.append(departureTime);
    result.append(", arrivalTime: ");
    result.append(arrivalTime);
    result.append(", numberOfSeats: ");
    result.append(numberOfSeats);
    result.append(", departureDate: ");
    result.append(departureDate);
    result.append(", price: ");
    result.append(price);
    result.append(')');
    return result.toString();
  }

} // Trip
